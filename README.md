# HiShop DC 2015
HiShop疯狂的程序员 - 2015 竞技大赛

本次大赛为HiShop组织的第一次开发者竞技形大赛，旨在提升开发者面对极端应用问题的快速分析和解决能力，以及团队的协作能力及技巧。

<a name="赛题" />
## 赛题
当下电商领域一个十分热门的场景，即商品秒杀抢购活动，实现一个最小的可用系统，模拟处理高并发情况的秒杀抢购业务。

## 要求
用自己和所在团队最为擅长的程序设计语言和基础框架搭建一个最小可用的HTTP服务，完整实现抢购业务中的基本流程环节（具体参见以下的[`HTTP服务接口规范`](#HTTP服务接口规范)章节），仅限大赛组织方提供的数据库系统及数据结构，可自选额外的具体性能优化方案。

推荐方案：
> * 系统平台：Windows Server / IIS（ASP.NET）
* 基础框架：.NET Framework 4.5
* 编程语言：C#

## 抢购业务描述

## 数据库及数据结构

<a name="HTTP服务接口规范" />
## HTTP服务接口规范
由于主要考验参赛者对核心业务的理解和处理能力，于是只要求参赛作品向评分系统输出正确的业务数据（JSON格式）即可，不用返回用于可视化的HTML内容。

所有的未指明错误（如参数无效）均返回：
```
{
  error: 'invalid parameters'
}
```

### 1. 抢购活动实时详情接口（GET方式）
模拟抢购场景中用户不停刷新活动商品详情页面时，对应用服务器及数据库系统的查询负载。

> /promotion

调用参数：

| 名称        | 类型        | 说明          | 示例                                 |
| :---------- | :---------- | :------------ | :----------------------------------- |
| uid         | string      | 用户唯一标识  |  12f8b2b9a74c4591a67a44b9ba0647e9    |
| prom_id     | string      | 抢购活动编号  |  3826ef14abfa52ca                    |
| rnd         | string      | 随机数        |  1448901407550                       |

输出示例：
```
{
  username: 'hike001',
  realname: '剁手未遂',
  purchased: 'true',
  product_name: 'HiShop 产品大全',
  start_time: '2015-11-30 08:30:00',
  end_time: '2015-11-30 09:30:00',
  price: '8888.88',
  stock: '15'
}
```

### 2. 提交抢购申请（POST方式）
模拟抢购场景中用户向系统确定抢购此件商品。

> /promotion/buy

调用参数：

| 名称        | 类型        | 说明          | 示例                                 |
| :---------- | :---------- | :------------ | :----------------------------------- |
| uid         | string      | 用户唯一标识  |  12f8b2b9a74c4591a67a44b9ba0647e9    |
| prom_id     | string      | 抢购活动编号  |  3826ef14abfa52ca                    |

输出示例：
```
// 提交成功
{
  order_id: '6801122339',
  username: 'hike001',
  realname: '剁手未遂',
  product_name: 'HiShop 产品大全',
  order_time: '2015-11-30 08:30:00',
  close_time: '2015-11-30 08:31:00'
}

// 已经抢光
{
  error: 'sold out'
}
```

### 3. 支付抢购订单（POST方式）
模拟抢购场景中用户支付已经成功提交的订单。

> /promotion/pay

调用参数：

| 名称        | 类型        | 说明          | 示例                                  |
| :---------- | :---------- | :------------ | :------------------------------------ |
| uid         | string      | 用户唯一标识  |  12f8b2b9a74c4591a67a44b9ba0647e9     |
| order_id    | string      | 订单号        |  6801122339                           |

输出示例：
```
// 提交成功
{
  order_id: '6801122339',
  username: 'hike001',
  realname: '剁手未遂',
  product_name: 'HiShop 产品大全',
  order_time: '2015-11-30 08:30:00',
  pay_time: '2015-11-30 08:30:45',
  close_time: '2015-11-30 08:31:00'
}

// 支付超时
{
  error: 'timeout'
}
```

